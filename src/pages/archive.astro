---
import Layout from "../layouts/Layout.astro";
import Navigation from "../components/Navigation.astro";
import Footer from "../components/Footer.astro";
import { getCollection } from "astro:content";
import { Fragment } from "astro/jsx-runtime";

// Tag colors (duplicated from Projects.astro for now)
const tagColors: Record<string, { bg: string; text: string }> = {
  Django: { bg: "bg-green-100", text: "text-green-800" },
  "Vue.js": { bg: "bg-blue-100", text: "text-blue-800" },
  PostgreSQL: { bg: "bg-purple-100", text: "text-purple-800" },
  FastAPI: { bg: "bg-red-100", text: "text-red-800" },
  Pandas: { bg: "bg-yellow-100", text: "text-yellow-800" },
  Polars: { bg: "bg-blue-100", text: "text-blue-800" },
  Python: { bg: "bg-red-100", text: "text-red-800" },
  Docker: { bg: "bg-indigo-100", text: "text-indigo-800" },
  // Defaults
  default: { bg: "bg-gray-100", text: "text-gray-800" },
};

// Project visuals (simplified)
const projectVisuals: Record<string, { gradient: string; svg: string }> = {
  // Add specific visuals if needed, otherwise rely on fallback
};

const projectCollection = await getCollection("projects");
const archivedProjects = projectCollection
  .filter((p) => p.data.archived)
  .sort((a, b) => b.data.date.localeCompare(a.data.date));
---

<Layout title="Archivo de Proyectos | Diego Rivera">
  <Navigation />
  
  <main class="pt-20 pb-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-4">
          Archivo de Proyectos
        </h1>
        <p class="text-gray-600 max-w-2xl mx-auto">
          Proyectos anteriores, experimentos y primeras versiones de aplicaciones.
        </p>
        <div class="w-20 h-1 bg-gradient-to-r from-gray-400 to-gray-600 mx-auto mt-4"></div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {
          archivedProjects.map((project) => (
            <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow opacity-90 hover:opacity-100">
               <div class={`h-48 flex items-center justify-center bg-gray-200`}>
                  <Fragment
                    set:html={`<svg class="w-16 h-16 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"></path></svg>`}
                  />
                </div>
              
              <div class="p-6">
                <h3 class="text-xl font-semibold text-gray-900 mb-2">
                  {project.data.title}
                </h3>
                <p class="text-gray-600 mb-4 text-sm">{project.data.description}</p>
                <div class="flex flex-wrap gap-2 mb-4">
                  {project.data.technologies.map((tech) => (
                    <span
                      class={`px-3 py-1 text-xs rounded-full ${tagColors[tech]?.bg || "bg-gray-100"} ${tagColors[tech]?.text || "text-gray-800"}`}
                    >
                      {tech}
                    </span>
                  ))}
                </div>
                <div class="flex justify-between items-center mt-4">
                  <a
                    href={project.data.link}
                    class="text-gray-600 hover:text-gray-900 font-medium text-sm flex items-center"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
                    Ver Repositorio
                  </a>
                  <span class="text-xs text-gray-500">{project.data.date}</span>
                </div>
              </div>
            </div>
          ))
        }
      </div>
      
      <div class="mt-12 text-center">
        <a href="/#projects" class="text-blue-600 hover:text-blue-800 font-medium">
          &larr; Volver a Proyectos Destacados
        </a>
      </div>
    </div>
  </main>

  <Footer />
</Layout>
